<link rel="import" href="../bower_components/polymer/polymer-element.html">

<dom-module id="menu-box">
    <template>
        <style>
            :host {
                display: none;
                opacity: 0;
                transition: opacity .3s;
                font-size: 14px;
                color: #fff;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            ul {
                list-style: none;
            }

            .title {
                font-size: 20px;
                text-align: center;
                margin: 30px 0;
            }

            .menuList {
                position: relative;
                z-index: 0;
                font-size: 16px;
                width: 220px;
                height: 54px;
                line-height: 54px;
                border: 1px solid #fff;
                margin: 20px auto;
                padding: 0 20px;
                overflow: hidden;
            }

            .menuList a {
                display: block;
                height: 100%;
                color: #fff;
                text-decoration: none;
            }

            label {
                width: 100%;
                height: 100%;
            }

            .createdElement {
                position: absolute;
                z-index: -1;
                width: 0;
                height: 0;
                transition: .4s ease-in;
                -webkit-transform: translate(-50%, -50%);
                        transform: translate(-50%, -50%);
                border-radius: 50%;
                background-color: #f8688a;
                opacity: .6;
            }
        </style>
        <p class="title">MENU</p>
        <ul class="menu" id="menu">
            <li class="menuList js-touchAciton"><a href="/messe/logout">ログアウトする</a></li>
        </ul>
    </template>

    <script>
    /**
     * @customElement
     * @polymer
     */
    class MenuBox extends Polymer.Element {
        static get is() { return 'menu-box'; }
        static get properties() {
            return {
                status: {
                    type: Boolean,
                    value: false,
                    observer: 'obs_toggleDisplay'
                },
            };
        }
        ready() {
            super.ready();
            const touchElement = this.$.menu.getElementsByClassName('js-touchAciton');
            for (var i = 0; i < touchElement.length; i++) {
                this.touchAction(touchElement[i]);
            }
            // touchElement[0].addEventListener('click', () => {
            //     setTimeout(()=> {
            //         const input = document.createElement('input');
            //         input.type = 'file';
            //         input.accept = 'image/*';
            //         input.addEventListener('change', this.loadLocalImage.bind(this), false)
            //         input.click();
            //     }, 300);
            // });
        }

        // loadLocalImage(e) {
        //     // ファイル情報を取得
        //     var fileData = e.target.files[0];
        //     console.log(fileData); // 取得した内容の確認用
    
        //     // 画像ファイル以外は処理を止める
        //     if(!fileData.type.match('image.*')) {
        //         console.log('画像を選択してください');
        //         return;
        //     }
    
        //     // FileReaderオブジェクトを使ってファイル読み込み
        //     var reader = new FileReader();
        //     // ファイル読み込みに成功したときの処理
        //     reader.onload = () => {
        //         localStorage.setItem('thumbnail', reader.result);
        //     }
        //     // ファイル読み込みを実行
        //     reader.readAsDataURL(fileData);
        // }

        touchAction(touchElement) {
            touchElement.addEventListener('touchstart', (e) => {
                const elementPositionY = touchElement.getBoundingClientRect().top + window.pageYOffset;
                const elementPositionX = touchElement.getBoundingClientRect().left;
                const positionData = e.changedTouches[0];
                const positionX = positionData.pageX - elementPositionX;
                const positionY = positionData.pageY - elementPositionY;
                this.createElement('span', touchElement, positionX, positionY);
            });
        }

        createElement(tagName, parent, positionX, positionY) {
            const element = document.createElement(tagName);
            element.className = 'createdElement';
            parent.appendChild(element);
            element.style.top = positionY + 'px';
            element.style.left = positionX + 'px';
            setTimeout(function () {
                element.style.width = "1000px";
                element.style.height = "1000px";
            }, 0);
            setTimeout(function () {
                parent.removeChild(element);
            }, 500)
        }

        obs_toggleDisplay() {
            const _this = this;
            if (this.status === true) {
                this.style.display = 'block';
                setTimeout(function(){_this.style.opacity = '1'}, 0);
            } else {
                this.style.display = 'none';
                this.style.opacity = '0';
            }
        }
    }
    window.customElements.define(MenuBox.is, MenuBox);
    </script>
</dom-module>
